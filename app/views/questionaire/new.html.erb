<h1>Who wants to be a questionaire</h1>

<div>
  <%= form_for(@survey, url: questionaire_create_path) do |f| %>
    <% if @survey.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(@survey.errors.count, "error") %> prohibited this survey from being saved:</h2>

        <ul>
        <% @survey.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
        </ul>
      </div>
    <% end %>

    <div>
        <%= f.hidden_field :id %>
        <%= f.fields_for :questions do |ff| %>
          <div>
            <%= ff.hidden_field :id %>
            <% ff.text_field :question_text %>
            <%= ff.object.question_text %>
            <%= ff.fields_for :answers, ff.object.answers.build do |fff| %>
              <div>
                <%= fff.hidden_field :taker_id, value: @taker.id %>
                <% case ff.object.question_type.category %>
                  <% when "Short" %>
                    <%= fff.text_field :answer, placeholder: "Answer" %>
                  <% when "Long" %>
                    <%= fff.text_area :answer, placeholder: "Answer" %>
                  <% when "YesNo" %>
                    <% ff.object.options.each do |o| %>
                      <% if o.option %>
                        <%= fff.label :answer_option, o.option %>
                        <%= fff.radio_button :answer, o.value %>
                      <% else %>
                        <%= fff.label :answer_option, o.value %>
                        <%= fff.radio_button :answer, o.value %>
                      <% end %>
                    <% end %>
                <% end %>
              </div>
            <% end %>
          </div>
        <% end %>
    </div>
    <div>
      <%= f.submit %>
    </div>
  <% end %>
</div>
